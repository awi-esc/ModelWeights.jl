<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filtering data · ModelWeights.jl</title><meta name="title" content="Filtering data · ModelWeights.jl"/><meta property="og:title" content="Filtering data · ModelWeights.jl"/><meta property="twitter:title" content="Filtering data · ModelWeights.jl"/><meta name="description" content="Documentation for ModelWeights.jl."/><meta property="og:description" content="Documentation for ModelWeights.jl."/><meta property="twitter:description" content="Documentation for ModelWeights.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelWeights.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelWeights.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting started</a></li><li><a class="tocitem" href="../../weights/">Computing weights</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../loading-data/">Loading data</a></li><li class="is-active"><a class="tocitem" href>Filtering data</a><ul class="internal"><li><a class="tocitem" href="#Filtering-based-on-filenames"><span>Filtering based on filenames</span></a></li><li><a class="tocitem" href="#level_shared:-Datasets-that-share-the-same-members/models"><span><code>level_shared</code>: Datasets that share the same members/models</span></a></li><li><a class="tocitem" href="#timeseries:"><span><code>timeseries</code>:</span></a></li></ul></li><li><a class="tocitem" href="../computing-weights/">Computing weights</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/API/">Public API</a></li><li><a class="tocitem" href="../../reference/references/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Filtering data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Filtering data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/awi-esc/ModelWeights.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/awi-esc/ModelWeights.jl/blob/main/docs/src/Manual/filtering-data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Filtering-data"><a class="docs-heading-anchor" href="#Filtering-data">Filtering data</a><a id="Filtering-data-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-data" title="Permalink"></a></h1><p>When loading data with the function <code>defineDataMap</code>, there is the option to filter the data in several ways, using the the optional keyword argument <code>constraint</code> which is a dictionary.</p><p>All keys in <code>constraint</code> except for two map to a Vector of Strings. The two exceptions are  <code>level_shared</code> and <code>timeseries</code> discussed seperately below. </p><h2 id="Filtering-based-on-filenames"><a class="docs-heading-anchor" href="#Filtering-based-on-filenames">Filtering based on filenames</a><a id="Filtering-based-on-filenames-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-based-on-filenames" title="Permalink"></a></h2><p>The following keys can be used to constrain the data that shall be loaded into the DataMap:</p><pre><code class="language-julia hljs">
constraint = Dict(
    &quot;variables&quot; =&gt; [&quot;tas&quot;, &quot;tos&quot;],
    &quot;models&quot; =&gt; [],
    &quot;variants&quot; =&gt; [],
    &quot;experiments&quot; =&gt; [],
    &quot;mips&quot; =&gt; [],
    &quot;grids&quot; =&gt; [],
    &quot;table_ids&quot; =&gt; [],
    &quot;filename&quot; =&gt; [],
    &quot;timeranges&quot; =&gt; Dict(),
    &quot;level_shared&quot; =&gt; # one of: &quot;member&quot;, &quot;model&quot;, :member, :model
)
</code></pre><ul><li><code>filename</code>:</li><li><code>mips</code>: </li><li><code>models</code>: if provided, only these models are loaded. It is possible to include (1)</li></ul><p>general models (e.g., &quot;ACCESS-CM2&quot;), which would load all available simulations of the respective model or (2) specific model simulations. The latter are specified as the <code>MODELNAME#VARIANT</code>, e.g., <code>&quot;ACCESS-CM2#r1i1p1f1&quot;</code>.  </p><h2 id="level_shared:-Datasets-that-share-the-same-members/models"><a class="docs-heading-anchor" href="#level_shared:-Datasets-that-share-the-same-members/models"><code>level_shared</code>: Datasets that share the same members/models</a><a id="level_shared:-Datasets-that-share-the-same-members/models-1"></a><a class="docs-heading-anchor-permalink" href="#level_shared:-Datasets-that-share-the-same-members/models" title="Permalink"></a></h2><p>The function that is called to constrain the loaded data by the models/members shared across all  datasets is <code>subsetModelData</code>. Note that this loads the data into memory.</p><h2 id="timeseries:"><a class="docs-heading-anchor" href="#timeseries:"><code>timeseries</code>:</a><a id="timeseries:-1"></a><a class="docs-heading-anchor-permalink" href="#timeseries:" title="Permalink"></a></h2><h3 id="Optional-parameters-for-filtering-data"><a class="docs-heading-anchor" href="#Optional-parameters-for-filtering-data">Optional parameters for filtering data</a><a id="Optional-parameters-for-filtering-data-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-parameters-for-filtering-data" title="Permalink"></a></h3><p>For both functions, <code>loadDataFromESMValToolRecipes</code> and <code>loadDataFromYAML</code>, there is a set of optional parameters in order to constrain the loaded data:</p><ul><li><p><code>preview</code>: If set to false (default), the data will not be loaded and only the metadata with the information that we added that specifies which data will be loaded is returned.</p></li><li><p><code>dir_per_var</code>: If set to true (default), only subdirectories of the base_path that contain <code>_VARIABLE</code> in their name will be searched. </p></li></ul><!-- `subset_shared`: Can be either `nothing` (default), `ModelWeights.MODEL` or `ModelWeights.MEMBER`. If set to `MODEL`, only data from the same models will be loaded. If, for instance, data from lgm and historical experiments shall be loaded, this configuration will ensure that for both, only the same models are loaded, i.e. those for which both experiments were done. While this considers models, not specific simulations, setting subset\_shared to `MEMBER` would only load models that share the exact same simulations (i.e. the same member\_id abbreviation, e.g. `r1i1p1f1`). --><ul><li><p><code>subset</code> is an optional parameter of type <code>Constraint</code> or <code>Nothing</code>. A Constraint further constrains the data to be loaded and has the following fields:</p><ul><li><code>variables</code>: The short name of the climate variable, e.g. [&quot;tas&quot;, &quot;tos&quot;].</li></ul><ul><li><code>statistics</code>: The statistic/diagnostic that was used when preprocessing the data. The names are generally arbitrary, but need to be identical to those you used in the preprocessing; for instance, we refer to the climatological average as &quot;CLIM&quot;, s.t. an example value for this argument is [&quot;CLIM&quot;].</li></ul><ul><li><code>aliases</code>: Like for <code>statistics</code>, the names are arbitrary but must be identical to what you used when preprocessing the data; e.g. [&quot;historical&quot;, &quot;historical1&quot;].</li></ul><p>An alias should refer to a certain <code>timerange</code> of a certain experiment, e.g. we call the time period from 1951-1980 &#39;historical1&#39;. To load only this data, it thus does not matter whether you set <code>timerange=[&quot;1951-1980&quot;]</code> or <code>alias=[&quot;historical1&quot;]</code>.</p><ul><li><p><code>timeranges</code>: Timeranges to be loaded; especially for historical data, you may preprocess data for different timeranges,  e.g. [&quot;full&quot;, &quot;1980-2014&quot;]. </p></li><li><p><code>projects</code>:  e.g. [&quot;CMIP5&quot;, &quot;CMIP6&quot;]. All filenames of the data to be loaded must contain at least one of the given strings. If not specified and <code>is_model_data=true</code>, it is set to [&quot;CMIP&quot;]. If not specified and <code>is_model_data=false</code>, it is set to [&quot;ERA5&quot;], the default observational dataset used.</p></li><li><p><code>models</code>: List of models or individual model members, e.g. [&quot;AWI-CM-1-1-MR&quot;]. All filenames must contain at least one of the given strings + &quot;_&quot;. The underscore is important since some models have names that are substrings of other models, e.g. &quot;CNRM-CM5&quot; and &quot;CNRM-CM5-C2&quot;. </p></li></ul><ul><li><code>base_subdirs</code>: If there is one directory for each climate variable (dir_per_var=true), you can use this argument to subset the considered subdirectories: if given, the data will be loaded only from subdirectories of the given base_dir that contain any of the provided values in <code>base_subdirs</code> in their name. That is, it&#39;s not necessary to specify full directory names here, parts of it are sufficient.</li></ul></li></ul><p>Note that when using the option to load data preprocessed with ESMValTool from a seperate yaml file,  in which it&#39;s possible to specify filtering options for each datasets, these values will be overwritten, if the same key is provided in the function argument, too.  That is, the function argument takes precedence over what had been specified in the yaml file if a key is specified in both. Otherwise if a key is just given in the yaml file, it will still be applied in the filtering.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../loading-data/">« Loading data</a><a class="docs-footer-nextpage" href="../computing-weights/">Computing weights »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 15 August 2025 10:58">Friday 15 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
