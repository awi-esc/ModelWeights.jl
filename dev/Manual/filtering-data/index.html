<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filtering data · ModelWeights.jl</title><meta name="title" content="Filtering data · ModelWeights.jl"/><meta property="og:title" content="Filtering data · ModelWeights.jl"/><meta property="twitter:title" content="Filtering data · ModelWeights.jl"/><meta name="description" content="Documentation for ModelWeights.jl."/><meta property="og:description" content="Documentation for ModelWeights.jl."/><meta property="twitter:description" content="Documentation for ModelWeights.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelWeights.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelWeights.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting started</a></li><li><a class="tocitem" href="../../weights/">Computing weights</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../loading-data/">Loading data</a></li><li class="is-active"><a class="tocitem" href>Filtering data</a><ul class="internal"><li><a class="tocitem" href="#level_shared:-Datasets-that-share-the-same-members/models"><span><code>level_shared</code>: Datasets that share the same members/models</span></a></li><li><a class="tocitem" href="#Further-filtering-options-for-data-preprocessed-with-ESMValTool"><span>Further filtering options for data preprocessed with ESMValTool</span></a></li></ul></li><li><a class="tocitem" href="../computing-weights/">Computing weights</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/API/">Public API</a></li><li><a class="tocitem" href="../../reference/references/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Filtering data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Filtering data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/awi-esc/ModelWeights.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/awi-esc/ModelWeights.jl/blob/main/docs/src/Manual/filtering-data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Filtering-data"><a class="docs-heading-anchor" href="#Filtering-data">Filtering data</a><a id="Filtering-data-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-data" title="Permalink"></a></h1><p>When loading data with the function <code>defineDataMap</code>, there is the option to filter the data in several ways, using the the optional keyword argument <code>constraint</code>. Note that the filtering is done based on the information retrieved from the filenames. That is, the provided values must correspond to how the data is stored. For CMIP6 data, variables must, for instance, point to the variables&#39; id, e.g. &#39;tas&#39;, &#39;psl&#39;, etc. </p><p>The following keys are considered for the dictionary <code>constraint</code>. If not stated otherwise, they map to a vector.</p><ul><li><code>experiments</code>: load only data from given experiments, e.g. [&quot;lgm&quot;, &quot;historical&quot;]</li><li><code>filenames</code>:  load only data from any of the given files</li><li><code>grids</code>: load only data with given grids, e.g. [&quot;gn&quot;]</li><li><code>mips</code>: load only data from given projects, e.g. to load only CMIP5 data, set to [&quot;CMIP5&quot;]</li><li><code>models</code>: load only data from given models. It is possible to include (1) general models (e.g., &quot;ACCESS-CM2&quot;), which would load all available simulations of the respective model or (2) specific model simulations. The latter are specified as the <code>MODELNAME#VARIANT</code>, e.g., <code>&quot;ACCESS-CM2#r1i1p1f1&quot;</code>.  </li><li><code>table_ids</code>: load only data from given tables, e.g. [&quot;Amon&quot;, &quot;Omon&quot;]</li><li><code>variables</code>: if provided, only data for given variables is loaded, otherwise all data in the specified directories is loaded.</li><li><code>variants</code>: load only specific runs, e.g. [&quot;r1i1p1f1&quot;, ...]</li><li><code>timeranges</code>: load only data from files for given timeranges, e.g. [&quot;185001-1850012&quot;, &quot;195001-195012&quot;]</li><li><code>level_shared::Union{String, Symbol}</code>: one of: &quot;member&quot;, &quot;model&quot;, :member, :model. The function that is called to constrain the loaded data by the models/members shared across all datasets is <code>subsetModelData</code>. For more details see next paragraph. </li></ul><h2 id="level_shared:-Datasets-that-share-the-same-members/models"><a class="docs-heading-anchor" href="#level_shared:-Datasets-that-share-the-same-members/models"><code>level_shared</code>: Datasets that share the same members/models</a><a id="level_shared:-Datasets-that-share-the-same-members/models-1"></a><a class="docs-heading-anchor-permalink" href="#level_shared:-Datasets-that-share-the-same-members/models" title="Permalink"></a></h2><p>This is the most important constraint. It allows to filter the data such that every loaded dataset contains only data from the same models or, more restricted, the same model variants/simulations. If set to <code>&quot;member&quot;</code> (or :member), data is only loaded if the respective \emph{model simulation} is present for all specified datasets, i.e. for every variable and experiment. If it is set to <code>&quot;model&quot;</code> (or :model), data is only loaded from models that provide data for all specified datasets, yet independent of the exact simulations. That is, every loaded dataset may have of a different number of simulations for each model.</p><h2 id="Further-filtering-options-for-data-preprocessed-with-ESMValTool"><a class="docs-heading-anchor" href="#Further-filtering-options-for-data-preprocessed-with-ESMValTool">Further filtering options for data preprocessed with ESMValTool</a><a id="Further-filtering-options-for-data-preprocessed-with-ESMValTool-1"></a><a class="docs-heading-anchor-permalink" href="#Further-filtering-options-for-data-preprocessed-with-ESMValTool" title="Permalink"></a></h2><p>Besides the possibility to specify the paths to the data directories directly, there are two more ways to load data that was preprocessed with ESMValTool, using the function <code>defineDataMap</code>:</p><ul><li><code>defineDataMap(path_data, path_recipes, source; dir_per_var::Bool=true)</code>: The first argument points to the top-level directory that contains the data, the second argument points to a directory that contains one or more ESMValTool recipes and source must be set to <code>:esmvaltool_recipes</code>. See <a href="../loading-data/#loading-data-recipes">loading data section based on recipes</a>  for more information.</li></ul><p>The additional keyword argument <code>dir_per_var</code> specifies whether there was one recipe per variable. If that&#39;s the case, there is a single directory for every variable and thus, to load data for a specific variable only subdirectories of the directory that <code>path_data</code> points to that contain the respective variable, more precisely <code>_VARIABLE</code> (e.g. <code>_tas</code>), in their name will be considered.</p><ul><li><code>defineDataMap(yaml_content::Dict)</code> and <code>defineDataMap(path_config::String)</code>: Here, the only positional argument is either a dictionary with the configuration or a path to a yaml file with the respective configurations. See <a href="../loading-data/#loading-data-config">loading data section based on config files</a> for more information.</li></ul><p>In both cases, it is possible to constrain the directories from where data is loaded by specifying <code>base_subdirs</code> in the dictionary input argument <code>constraint</code>:</p><ul><li><code>&quot;base_subdirs&quot;::Vector{String}</code>: If specified and if there is a single directory for every variable (default: true), only data is loaded from subdirectories of the given data path (<code>base_path_data</code> + <code>base_dir</code> when loading from yaml file) that contain any of the given strings in their name.</li></ul><p>TODO: following must be updated</p><ul><li><code>subset</code><ul><li><code>variables</code>: The short name of the climate variable, e.g. [&quot;tas&quot;, &quot;tos&quot;].</li></ul><ul><li><code>statistics</code>: The statistic/diagnostic that was used when preprocessing the data. The names are generally arbitrary, but need to be identical to those you used in the recipe for preprocessing the data; for instance, we refer to the climatological average as &quot;CLIM&quot;, s.t. an example value for this argument is [&quot;CLIM&quot;].</li></ul><ul><li><code>aliases</code>: Like for <code>statistics</code>, the names are arbitrary but must be identical to the name you used in the recipe for preprocessing the data; an alias may, for instance, refer to a certain <code>timerange</code> of a certain experiment, e.g. <code>&quot;historical-1950-1980&quot;</code>.</li></ul><ul><li><code>timeranges</code>: Timeranges to be loaded; especially for historical data, you may preprocess data for different timeranges,  e.g. [&quot;full&quot;, &quot;1980-2014&quot;]. </li></ul></li></ul><p>Note that when using the option to load data preprocessed with ESMValTool from a seperate yaml file, in which it&#39;s possible to specify filtering options for each datasets, these values will be overwritten, if the same key is provided in the function argument, too. That is, the function argument takes precedence over what had been specified in the yaml file if a key is specified in both. If a key is just given in the yaml file, it will still be applied in the filtering.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../loading-data/">« Loading data</a><a class="docs-footer-nextpage" href="../computing-weights/">Computing weights »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 19 August 2025 12:21">Tuesday 19 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
